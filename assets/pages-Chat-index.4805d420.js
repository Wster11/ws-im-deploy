import{d as A,o as e,c as s,w as a,f as t,t as l,k as o,r as n,b as i,$ as r,i as c,J as u,g,n as m,S as d,a0 as p,a1 as v,a2 as B,e as I,H as h,a as f,P as w,s as F,E as C,a3 as U,L as Q,G as y,a4 as D,M as E,N as K,O as V,a5 as k,a6 as R,a7 as G,l as H,a8 as Y,V as x,a9 as M,x as X,W as T,A as b,aa as J,ab as L,ac as N,F as S,B as O,ad as W,ae as q}from"./index-570604c4.js";import{A as j,d as Z}from"./defaultAvatar.b2cfb2fc.js";import{_ as z}from"./_plugin-vue_export-helper.1b428a4d.js";const P=z(A({__name:"messageTxt",props:{msg:{}},setup:A=>(A,n)=>{const i=o;return e(),s(i,{class:"msg-text"},{default:a((()=>[t("span",{class:"msg"},l(A.msg.msg),1)])),_:1})}}),[["__scopeId","data-v-9dc49f14"]]),_="/assets/img404-edd00584.jpg",$=z(A({__name:"messageImage",props:{msg:{}},setup(A){const t=A,l=n(!1),u=()=>{l.value=!0,t.msg.thumb=_},g=()=>{l.value||r({urls:[t.msg.url||""]})};return(A,t)=>{const l=c,n=o;return e(),s(n,{class:"msg-image"},{default:a((()=>[i(l,{onError:u,onClick:g,class:"image",src:A.msg.thumb,mode:"aspectFit"},null,8,["src"])])),_:1})}}}),[["__scopeId","data-v-655399c9"]]),AA=z(A({__name:"messageVideo",props:{msg:{}},setup(A){const t=A,l=n(!1),r=()=>{t.msg.thumb=_,l.value=!0},d=()=>{m({url:`../../pages/VideoPreview/index?url=${t.msg.url}`})};return(A,t)=>{const n=c,m=o;return e(),s(m,{class:"msg-video"},{default:a((()=>[i(m,{class:"video-poster"},{default:a((()=>[i(n,{onError:r,class:"image",src:A.msg.thumb,mode:"aspectFit"},null,8,["src"]),l.value?g("",!0):(e(),s(m,{key:0,onClick:d,class:"video-play-btn"},{default:a((()=>[i(n,{class:"video-play-btn-image",src:u("/assets/video-play-btn-1fc990f0.png")},null,8,["src"])])),_:1}))])),_:1})])),_:1})}}}),[["__scopeId","data-v-c4d20d49"]]),eA=z(A({__name:"messageAudio",props:{msg:{}},setup(A){const t=d().getChatConn(),r=A,g=p(),m=n(!1),h=t.user===r.msg.from||""===r.msg.from,f=v(),{setAudioInstance:w}=f;g.onPlay((()=>{f.audioInstance&&f.audioInstance.stop(),w(g),m.value=!0})),g.onStop((()=>{m.value=!1})),g.onPause((()=>{m.value=!1})),g.onError((()=>{m.value=!1}));const F=()=>{g.src=r.msg.url||"",g.play()};return B((()=>{g.stop()})),(A,t)=>{const n=o,g=c;return e(),s(n,{class:"msg-audio"},{default:a((()=>[i(n,{class:"content-wrap",onClick:F},{default:a((()=>[u(h)?(e(),s(n,{key:0,class:"content"},{default:a((()=>[i(n,null,{default:a((()=>[I(l(r.msg.length)+"'' ",1)])),_:1}),i(g,{class:"image",src:m.value?u("data:image/gif;base64,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"):u("data:image/png;base64,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"),mode:"aspectFit"},null,8,["src"])])),_:1})):(e(),s(n,{key:1,class:"content"},{default:a((()=>[i(g,{class:"image",src:m.value?u("data:image/gif;base64,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"):u("data:image/png;base64,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"),mode:"aspectFit"},null,8,["src"]),i(n,null,{default:a((()=>[I(l(r.msg.length)+"''",1)])),_:1})])),_:1}))])),_:1})])),_:1})}}}),[["__scopeId","data-v-bf20b262"]]),sA=z(A({__name:"messageOperation",props:{msg:{},isSelf:{type:Boolean}},setup(A){const{recallMessage:t}=v(),{getCvsIdFromMessage:n}=h(),{t:r}=f(),c=A,{msg:g,isSelf:m}=c,d=()=>{t({mid:g.id,to:n(g),chatType:g.chatType}).catch((A=>{F({title:`${r("recallFailed")} ${A.message}`,icon:"none"})}))};return(A,t)=>{const n=o;return e(),s(n,{class:"msg-operation",style:w(u(m)?{right:0}:{left:0})},{default:a((()=>[i(n,{class:"content"},{default:a((()=>[i(n,{class:"msg-operate-item",onClick:d},{default:a((()=>[I(l(A.$t("recall")),1)])),_:1})])),_:1})])),_:1},8,["style"])}}}),[["__scopeId","data-v-eca68a83"]]),aA=z(A({__name:"messageItem",props:{msg:{}},setup(A){var t;const r=n(!1),c=A,m=C(),{getUserInfoFromStore:p}=m,v=d().getChatConn().user===c.msg.from||""===c.msg.from,B=()=>{r.value=!0},h=(null==(t=c.msg.ext)?void 0:t.ease_chat_uikit_user_info)||{};return(A,t)=>{const n=o;return e(),s(n,{class:"msg-item-wrap",style:w({flexDirection:u(v)?"row-reverse":"row"})},{default:a((()=>[i(n,{class:"avatar-wrap"},{default:a((()=>[i(j,{src:u(p)(A.msg.from||"").avatar||u(h).avatarURL||"",placeholder:u(Z)},null,8,["src","placeholder"])])),_:1}),i(n,{class:"msg-content",style:w({textAlign:u(v)?"right":"left"})},{default:a((()=>[u(v)?g("",!0):(e(),s(n,{key:0},{default:a((()=>[I(l(u(p)(A.msg.from||"").nickname||u(h).nickname),1)])),_:1})),r.value?(e(),s(n,{key:1,class:"mask",onClick:t[0]||(t[0]=A=>r.value=!r.value)})):g("",!0),i(n,{class:"msg-bubble",onLongpress:B},{default:a((()=>[r.value&&u(v)?(e(),s(sA,{key:0,msg:A.msg,isSelf:u(v)},null,8,["msg","isSelf"])):g("",!0),"txt"===A.msg.type?(e(),s(n,{key:1},{default:a((()=>[i(P,{msg:A.msg},null,8,["msg"])])),_:1})):"img"===A.msg.type?(e(),s(n,{key:2},{default:a((()=>[i($,{msg:A.msg},null,8,["msg"])])),_:1})):"video"===A.msg.type?(e(),s(n,{key:3},{default:a((()=>[i(AA,{msg:A.msg},null,8,["msg"])])),_:1})):"audio"===A.msg.type?(e(),s(n,{key:4},{default:a((()=>[i(eA,{msg:A.msg},null,8,["msg"])])),_:1})):"custom"===A.msg.type?(e(),s(n,{key:5},{default:a((()=>[i(n,null,{default:a((()=>[I("[Custom]")])),_:1})])),_:1})):g("",!0)])),_:1})])),_:1},8,["style"])])),_:1},8,["style"])}}}),[["__scopeId","data-v-9c1d2995"]]),tA=z(A({__name:"messageTime",props:{currTime:{},prevTime:{}},setup(A){const t=A,i=n(!1),r=n("");return U((()=>[t.currTime,t.prevTime]),((A,e)=>{var s,a;(null==A?void 0:A.toString())!==(null==e?void 0:e.toString())&&(r.value=(s=t.currTime,a=t.prevTime,i.value=!0,s<=0?"":!a||a<=0||s-a>=6e5?(i.value=!0,Q(s,!0)):""))}),{immediate:!0}),(A,t)=>{const n=o;return i.value?(e(),s(n,{key:0,class:"message-time"},{default:a((()=>[I(l(r.value),1)])),_:1})):g("",!0)}}}),[["__scopeId","data-v-3b89e200"]]),lA=z(A({__name:"noticeMessageItem",props:{msg:{}},setup(A){var t,n,r,c;const m=C(),d=A,{msg:p}=d,v=m.getUserInfoFromStore(null==(n=null==(t=null==p?void 0:p.noticeInfo)?void 0:t.ext)?void 0:n.from).name,B=(null==(r=p.noticeInfo)?void 0:r.ext)||{},h=null==(c=p.noticeInfo)?void 0:c.noticeType;return(A,t)=>{const n=o;return e(),s(n,{class:"msg-notice"},{default:a((()=>[i(n,{class:"notice"},{default:a((()=>[i(n,{class:"notice-content"},{default:a((()=>[i(n,{class:"notice-text"},{default:a((()=>["recall"===u(h)?(e(),s(n,{key:0},{default:a((()=>[I(l(`"${u(v)}" ${A.$t("recallNotice")}`),1)])),_:1})):"group"===u(h)?(e(),s(n,{key:1},{default:a((()=>[I(l(`"${u(v)}" ${u(B).operation} ${A.$t("group")}`),1)])),_:1})):g("",!0)])),_:1})])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-36786113"]]),oA=z(A({__name:"messageList",props:{msgs:{},conversationId:{},conversationType:{}},setup(A,{expose:t}){const r=A,c=n(300*r.msgs.length),u=n(!1),m=n(""),d=v(),{getHistoryMessages:p}=d,B=y((()=>{var A;return null==(A=d.conversationMessagesMap.get(r.conversationId))?void 0:A.isLast})),h=y((()=>{var A;return null==(A=d.conversationMessagesMap.get(r.conversationId))?void 0:A.cursor})),f=async()=>{if(!0===u.value)return;u.value=!0;const A=r.msgs[0].id;try{await p({conversationId:r.conversationId,conversationType:r.conversationType},h.value),k((()=>{m.value=A;const e=setTimeout((()=>{u.value=!1,m.value="",clearTimeout(e)}),300)}))}catch(e){u.value=!1}},w=()=>{c.value+=300};return D((()=>{w()})),t({toBottomMsg:w}),(A,t)=>{const n=o,r=R;return e(),s(n,{class:"msg-list-wrap"},{default:a((()=>[i(r,{"scroll-y":"","scroll-top":c.value,class:"message-scroll-list",style:{height:"100%"},"scroll-into-view":`msg-${m.value}`},{default:a((()=>[A.msgs&&!B.value?(e(),s(n,{key:0,class:"loadMore",onClick:f},{default:a((()=>[I(l(A.$t("loadMore")),1)])),_:1})):g("",!0),(e(!0),E(V,null,K(A.msgs,((t,l)=>(e(),s(n,{class:"scroll-msg-item",id:`msg-${t.id}`,key:t.id},{default:a((()=>{var a;return[i(tA,{"curr-time":t.time,"prev-time":l>0?A.msgs[l-1].time:0},null,8,["curr-time","prev-time"]),"notice"===(null==(a=null==t?void 0:t.noticeInfo)?void 0:a.type)?(e(),s(lA,{key:0,msg:t},null,8,["msg"])):(e(),s(aA,{key:1,msg:t},null,8,["msg"]))]})),_:2},1032,["id"])))),128))])),_:1},8,["scroll-top","scroll-into-view"])])),_:1})}}}),[["__scopeId","data-v-b5b02927"]]),nA=z(A({__name:"index",emits:["onMessageSend","onShowToolbar"],setup(A,{emit:t}){const l=t,r=h(),{getSelfUserInfo:m}=C(),{sendMessage:p}=v(),{getChatSDK:B}=d(),I=n(!1),f=B(),w=n(""),U=()=>{I.value=!1,l("onShowToolbar")},Q=async()=>{const A=f.message.create({to:r.currConversation.conversationId,chatType:r.currConversation.conversationType,type:"txt",msg:w.value,ext:{ease_chat_uikit_user_info:{avatarURL:m().avatar,nickname:m().name}}});w.value="";try{await p(A),k((()=>{l("onMessageSend")}))}catch(e){F({title:`send failed: ${e.message}`,icon:"none"})}};return(A,t)=>{const l=H,n=o,r=c;return e(),s(n,{class:"message-input-wrap"},{default:a((()=>[I.value?g("",!0):(e(),s(n,{key:0,class:"send-input"},{default:a((()=>[i(l,{modelValue:w.value,"onUpdate:modelValue":t[0]||(t[0]=A=>w.value=A),"adjust-position":!0,"auto-blur":!0,"confirm-type":"send",onConfirm:Q,placeholder:A.$t("sendMessagePlaceholder")},null,8,["modelValue","placeholder"])])),_:1})),i(n,{class:"icon-wrap"},{default:a((()=>[i(r,{class:"icon",onClick:G(U,["stop"]),src:u("data:image/png;base64,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")},null,8,["src"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-a08194cd"]]),iA=z(A({__name:"itemContainer",props:{title:{},iconUrl:{}},setup(A){const t=A,{title:n,iconUrl:r}=t;return(A,t)=>{const g=c,m=o;return e(),s(m,{class:"tool-item-wrap"},{default:a((()=>[i(m,{class:"icon-wrap"},{default:a((()=>[i(g,{class:"icon",src:u(r)},null,8,["src"])])),_:1}),i(m,null,{default:a((()=>[I(l(u(n)),1)])),_:1})])),_:1})}}}),[["__scopeId","data-v-389692d7"]]),rA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAM0SURBVHgB7ZpNTttAFMffew5Sd80RzA3SG8CiLapEa2grdQc9QeEEhRMAJ4BlpZbKKVIV0QXcAG5QHyErWjV4pu8lTBpgnA97TG2Yn4SS2GPLP3vmPx8GwOPxeDwej8dTDjipwFL0ZgFSFSqkECoMauhiAOed+Mvp2HJZO5aiKNQ62NcaFqBeJERzi534U2LbSVlHKRWc1FBWCJXqnS1F70LbTqvw0+XVdTkQ6ktT696+bUfDtpEI1/jpDuF6v4eEMVQazhmNO6ChKb/4+lu2UtY2/Ozl65/w7wknx98O56EG8HUf8Mea+c1tef5mWyZ4YHjh+04DChJFUfM3NFr9wQlg9/josNLhVkj4afS2daHUCWdiE3CQfxwcSYNo5Xv8+RwqSO4qLSMx7MsOuoERwkventXx/29yC/Ow8yPcljU0teptQAUpIIytsfsBXkEFKZDSujluLzfpLlSQ3KHFT7DNMfVhTJGZQusFB6BK05YkfSOgpKzQyy0cULqrdLBmxq6j8NNNEOe2J51DurQLRXzTcIODbpj0/L2f9lrr7R9HXw/AIbmrdCeOE8L0iciNbkfEU5bNnI8aJOUvVHDGR2yBPfxCPte+jOtdJn6hflik+WNeVkUUt2kNlBxPURVFVubbMN0UVOa30s1NvInTUHikJUxaVhnFKisBp3EPSA9uloIIRmY94FDaifC02GSv2vtip31NJOayW9zXy6qLKetE+s4mD2NlLQLSXBDTxRsZYaRDyMmdCM8qayhDunThvLIG19KlCheVNYyTlr4cZqA0YVeyhizpX2ljHWagFGHXsgabNAZqpjG7c+GyZA1Gms+6TaTfd+LZhp5O++GyZQ1XI7wtyIGzJ3xXskVxIlwXWcGJsLxlhBrICm6EgYZJWWVZwUloEfY2Fcz1vyMGm1WVFRxND/upuQI14H69akF6PKlIxhPGbn+ZbkD4fHl1AwOq5JsEg0p5FVWra0vHtqaVVaXb/Dc8WCPuaKWh0uCtn21bMWuV/kOXuzcX52oFLxkhzVnffFiFT+O4a5mZ1AK5Zo2U2S1O9X9avEy8ADWAtEoeBSpmKvnWw+PxeDwezwPjLy/PrncjmFaVAAAAAElFTkSuQmCC",cA=z(A({__name:"imageUpload",props:{title:{}},setup(A){const{t:t}=f(),l=t("imageUpload"),n=Y("InputToolbarEvent"),{getChatConn:r,getChatSDK:c}=d(),{sendMessage:g}=v(),{getSelfUserInfo:m}=C(),p=h(),B=r(),I=c(),w=()=>{x({count:1,sourceType:["album"],success:function(A){U(A)}})},U=A=>{var e,s;const a=(null==(e=null==A?void 0:A.tempFilePaths)?void 0:e[0])||(null==(s=null==A?void 0:A.tempFiles)?void 0:s[0].tempFilePath),l=`${M}/${B.orgName}/${B.appName}/chatfiles`;if(!a)return;X();const o=B.token;T({url:l,filePath:a,fileType:"image",name:"file",header:{Authorization:"Bearer "+o},success:async A=>{console.log("图片上传成功",A);const e=JSON.parse(A.data),s=I.message.create({type:"img",to:p.currConversation.conversationId,chatType:p.currConversation.conversationType,url:e.uri+"/"+e.entities[0].uuid,ext:{ease_chat_uikit_user_info:{avatarURL:m().avatar,nickname:m().name}}});try{await g(s),null==n||n.onMessageSend(),null==n||n.closeToolbar()}catch(a){F({title:`send failed: ${a.message}`,icon:"none"})}b()},fail:A=>{b(),F({title:t("uploadFailed"),icon:"none"})}})};return(A,t)=>{const n=o;return e(),s(n,{class:"tool-image-wrap tool-item",onClick:w},{default:a((()=>[i(iA,{title:u(l),iconUrl:u(rA)},null,8,["title","iconUrl"])])),_:1})}}}),[["__scopeId","data-v-be8ed99e"]]),uA=z(A({__name:"videoUpload",props:{title:{}},setup(A){const{t:t}=f(),l=t("videoUpload"),n=Y("InputToolbarEvent"),{getChatConn:r,getChatSDK:c}=d(),{sendMessage:g}=v(),m=r(),{getSelfUserInfo:p}=C(),B=c(),I=h(),w=()=>{J({sourceType:["camera","album"],success:function(A){console.log(A,"resresresres"),U(A)}})},U=A=>{const e=null==A?void 0:A.tempFilePath,s=`${M}/${m.orgName}/${m.appName}/chatfiles`;if(!e)return;X();const a=m.token;console.log(a,"  token");T({url:s,filePath:e,fileType:"video",name:"file",header:{Authorization:"Bearer "+a},success:async A=>{const e=JSON.parse(A.data),s=B.message.create({type:"video",to:I.currConversation.conversationId,chatType:I.currConversation.conversationType,file_length:A.duration,body:{url:e.uri+"/"+e.entities[0].uuid},ext:{ease_chat_uikit_user_info:{avatarURL:p().avatar,nickname:p().name}}});try{await g(s),null==n||n.onMessageSend(),null==n||n.closeToolbar()}catch(a){F({title:`send failed: ${a.message}`,icon:"none"})}b()},fail:A=>{b(),F({title:t("uploadFailed"),icon:"none"})}})};return(A,t)=>{const n=o;return e(),s(n,{class:"tool-video-wrap tool-item",onClick:w},{default:a((()=>[i(iA,{title:u(l),iconUrl:u(rA)},null,8,["title","iconUrl"])])),_:1})}}}),[["__scopeId","data-v-ea1257ff"]]),gA=z(A({__name:"index",emits:["onMessageSend"],setup:(A,{emit:t})=>(A,t)=>{const l=L,n=N,r=o;return e(),s(r,{class:"message-input-toolbar"},{default:a((()=>[i(n,{class:"swiper"},{default:a((()=>[i(l,{class:"swiper-item"},{default:a((()=>[i(cA),i(uA)])),_:1})])),_:1})])),_:1})}}),[["__scopeId","data-v-6dc12f81"]]),mA=z(A({__name:"index",setup(A){const t=n(null),l=n(""),r=n(!1),c=n(""),u=v(),m=C(),d=S(),{getHistoryMessages:p}=u,{markConversationRead:I,setCurrentConversation:f}=h(),w=y((()=>{var A;return null==(A=u.conversationMessagesMap.get(l.value))?void 0:A.messages})),F=()=>{var A;null==(A=null==t?void 0:t.value)||A.toBottomMsg()},U=()=>{!0===r.value&&(r.value=!1)};return D((()=>{if(!l.value&&!c.value)return;I({conversationId:l.value,conversationType:c.value});w.value||p({conversationId:l.value,conversationType:c.value})})),B((()=>{f(null)})),O((A=>{var e;if(c.value=null==A?void 0:A.type,l.value=null==A?void 0:A.id,null==A?void 0:A.id){f({conversationId:l.value,conversationType:c.value});let A="";A="singleChat"===c.value?m.getUserInfoFromStore(l.value).name:(null==(e=d.joinedGroupList.find((A=>A.groupId===l.value)))?void 0:e.groupName)||"",W({title:A})}})),q("InputToolbarEvent",{onMessageSend:F,closeToolbar:U}),(A,n)=>{const u=o;return e(),s(u,{class:"chat-wrap"},{default:a((()=>[i(u,{class:"msgs-wrap"},{default:a((()=>[r.value?(e(),s(u,{key:0,class:"mask",onClick:U})):g("",!0),w.value?(e(),s(oA,{key:1,ref_key:"msgListRef",ref:t,msgs:w.value,conversationId:l.value,conversationType:c.value},null,8,["msgs","conversationId","conversationType"])):g("",!0)])),_:1}),i(u,{class:"chat-input-wrap",onClick:U},{default:a((()=>[i(nA,{onOnMessageSend:F,onOnShowToolbar:n[0]||(n[0]=A=>r.value=!0)})])),_:1}),r.value?(e(),s(u,{key:0,class:"chat-input-toolbar-wrap"},{default:a((()=>[i(gA)])),_:1})):g("",!0)])),_:1})}}}),[["__scopeId","data-v-4a29b473"]]);export{mA as default};
