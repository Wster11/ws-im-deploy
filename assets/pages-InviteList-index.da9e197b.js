import{d as e,F as a,B as s,a as l,r as t,A as u,D as r,s as n,o as i,c as o,w as d,b as c,H as v,J as p,K as m,e as f,t as _,h as g,k as h,q as y,m as I,g as b,n as k,p as w}from"./index-0e812019.js";import{A as T,d as x}from"./defaultAvatar.5704f27d.js";import{_ as U}from"./_plugin-vue_export-helper.1b428a4d.js";const j=U(e({__name:"index",setup(e){const U=a(),j=s(),{t:q}=l(),{inviteJoinGroup:A,removeUserFromGroup:B}=j,C=t(""),D=t("invite"),F=t([]),S=u(),{getUserInfoFromStore:G}=S,J=r((()=>{var e;return null==(e=j.groupDetailMap.get(C.value))?void 0:e.affiliations.map((e=>({userId:(null==e?void 0:e.owner)||(null==e?void 0:e.member)})))})),M=e=>{F.value=e.detail.value},$=r((()=>{var e;return"remove"===D.value?null==(e=J.value)?void 0:e.filter((e=>{var a;return e.userId!==(null==(a=j.groupDetailMap.get(C.value))?void 0:a.owner)})):U.contacts})),H=e=>{var a;return"remove"!==D.value&&!!(null==(a=J.value)?void 0:a.find((a=>a.userId===e)))},K=async()=>{try{await A(C.value,F.value),uni.showToast({title:q("requestSended"),icon:"success",duration:2e3});const e=setTimeout((()=>{uni.navigateBack(),clearTimeout(e)}),1e3)}catch(e){console.error(e)}},z=async()=>{try{await B(C.value,F.value),uni.showToast({title:q("requestSended"),icon:"success",duration:2e3});const e=setTimeout((()=>{uni.navigateBack(),clearTimeout(e)}),1e3)}catch(e){console.error(e)}};return n((async e=>{C.value=null==e?void 0:e.id,D.value=null==e?void 0:e.type})),(e,a)=>{const s=k,l=h,t=w,u=y,r=I;return i(),o(l,{class:"invite-group-wrap"},{default:d((()=>[c(l,{class:"content"},{default:d((()=>[c(u,{class:"uni-list",onChange:M},{default:d((()=>[(i(!0),v(m,null,p($.value,(e=>(i(),o(t,{class:"uni-list-cell uni-list-cell-pd",key:e.userId},{default:d((()=>[c(l,null,{default:d((()=>[c(s,{checked:H(e.userId),value:e.userId,disabled:H(e.userId)},null,8,["checked","value","disabled"])])),_:2},1024),c(l,{class:"user-item-wrap"},{default:d((()=>[c(T,{src:b(G)(e.userId).avatar,placeholder:b(x)},null,8,["src","placeholder"]),c(l,{class:"user-name"},{default:d((()=>[f(_(b(G)(e.userId).name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),"invite"===D.value?(i(),o(r,{key:0,class:"opt-btn",onClick:K,type:"primary",disabled:0===F.value.length},{default:d((()=>[f(_(e.$t("inviteUser")),1)])),_:1},8,["disabled"])):g("",!0),"remove"===D.value?(i(),o(r,{key:1,class:"opt-btn",type:"warn",onClick:z,disabled:0===F.value.length},{default:d((()=>[f(_(e.$t("removeUser")),1)])),_:1},8,["disabled"])):g("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-695a3754"]]);export{j as default};
