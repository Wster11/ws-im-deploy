import{d as e,B as a,x as s,K as l,a as t,r,o,c as u,w as n,b as c,A as d,e as i,t as p,i as A,j as g,k as f,L as I,v as w,y as k,f as v,M as C,l as h,g as m,E as B,F as G,G as y}from"./index-a5a208fc.js";import{A as Q,d as _}from"./defaultAvatar.c6c7c8ae.js";import{d as O}from"./defaultGroupAvatar.4ee83176.js";import{_ as D}from"./_plugin-vue_export-helper.1b428a4d.js";const E="data:image/png;base64,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",S=D(e({__name:"index",props:{searchType:{}},emits:["onCancel"],setup(e,{emit:I}){const w=e,{searchType:k}=w,{addContact:v,contacts:C}=a(),{applyJoinGroup:h}=s(),{getChatConn:m}=l(),B=m(),G=I,{t:y}=t(),D=r(""),S=r(!1),U=()=>{S.value=!0},b=()=>{G("onCancel")},F=()=>{if("contact"===k){if(D.value===B.user)return void uni.showToast({icon:"none",title:y("disabledAddSelf")});if(null==C?void 0:C.find((e=>e.userId===D.value)))return void uni.showToast({icon:"none",title:y("alreadyContact")});v(D.value),uni.showToast({title:y("requestSended")})}else h(D.value).then((()=>{uni.showToast({title:y("requestSended")})})).catch((e=>{var a;uni.showToast({icon:"none",title:null==(a=null==e?void 0:e.data)?void 0:a.error_description})}))};return(e,a)=>{const s=A,l=g,t=f;return o(),u(l,{class:"contact-search-wrap"},{default:n((()=>[c(l,{class:"search-title-wrap"},{default:n((()=>[c(s,{onClick:b,class:"arrow-back",src:d(E)},null,8,["src"]),c(l,{class:"title"},{default:n((()=>[i(p("contact"===d(k)?e.$t("addContact"):e.$t("addGroup")),1)])),_:1})])),_:1}),c(l,{class:"input-content-wrap"},{default:n((()=>[c(l,{class:"input-wrap"},{default:n((()=>[c(t,{modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),onConfirm:U,placeholder:e.$t("searchPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),c(l,{onClick:b,class:"cancel"},{default:n((()=>[i(p(e.$t("cancel")),1)])),_:1})])),_:1}),c(l,{class:"search-content"},{default:n((()=>[S.value?(o(),u(l,{key:1,class:"search-result"},{default:n((()=>[c(l,{class:"search-result-item"},{default:n((()=>[c(l,{class:"info-wrap"},{default:n((()=>[c(Q,{src:"",placeholder:"contact"===d(k)?d(_):d(O)},null,8,["placeholder"]),c(l,{class:"user-id"},{default:n((()=>[i(p(D.value),1)])),_:1})])),_:1}),c(l,{class:"add",onClick:F},{default:n((()=>[i(p(e.$t("add")),1)])),_:1})])),_:1})])),_:1})):(o(),u(l,{key:0},{default:n((()=>[i(p(e.$t("searchNoContact")),1)])),_:1}))])),_:1})])),_:1})}}}),[["__scopeId","data-v-fd88995e"]]),U=D(e({__name:"index",setup(e){const s=a(),l=I(),m=w(),{t:B}=t(),{blockUser:G,unBlockUser:y}=l,O=r(""),D=r(!1),S=k((()=>l.blockList.includes(s.viewedUserInfo.userId))),U=()=>{s.setViewedUserInfo({userId:"",remark:""})},b=async()=>{await s.setContactRemark(s.viewedUserInfo.userId,O.value),s.setViewedUserInfo({userId:s.viewedUserInfo.userId,remark:O.value}),D.value=!1},F=async e=>{uni.showLoading();try{e.detail.value?await G(s.viewedUserInfo.userId):await y(s.viewedUserInfo.userId),uni.hideLoading()}catch(a){uni.hideLoading()}uni.hideLoading()},T=()=>{uni.navigateTo({url:`../../pages/Chat/index?type=singleChat&id=${s.viewedUserInfo.userId}`}),U()},H=k((()=>m.getUserInfoFromStore(s.viewedUserInfo.userId))),J=()=>{s.deleteContact(s.viewedUserInfo.userId).then((()=>{uni.showToast({title:B("deleteSuccess")}),U()}))};return(e,a)=>{const l=A,t=g,r=f,I=C,w=h;return o(),u(t,{class:"user-wrap"},{default:n((()=>[c(t,{class:"user-header-wrap"},{default:n((()=>[c(l,{onClick:U,class:"arrow-back",src:d(E)},null,8,["src"]),c(t,{class:"title"},{default:n((()=>[i(p(e.$t("contactDetail")),1)])),_:1})])),_:1}),c(t,{class:"user-info-wrap"},{default:n((()=>[c(Q,{class:"user-avatar",src:H.value.avatar,placeholder:d(_)},null,8,["src","placeholder"]),c(t,null,{default:n((()=>[c(t,{class:"remark"},{default:n((()=>[i(p(H.value.name),1)])),_:1}),c(t,{class:"user-id"},{default:n((()=>[i(p(d(s).viewedUserInfo.userId),1)])),_:1})])),_:1})])),_:1}),c(t,{class:"user-remark-wrap"},{default:n((()=>[c(t,null,{default:n((()=>[i(p(e.$t("remark"))+": ",1),v("span",null,p(D.value?"":d(s).viewedUserInfo.remark),1)])),_:1}),D.value?(o(),u(r,{key:0,class:"remark-input",onConfirm:b,placeholder:e.$t("remarkPlaceholder"),modelValue:O.value,"onUpdate:modelValue":a[0]||(a[0]=e=>O.value=e)},null,8,["placeholder","modelValue"])):(o(),u(t,{key:1,onClick:a[1]||(a[1]=e=>D.value=!0)},{default:n((()=>[i(p(e.$t("editRemark")),1)])),_:1}))])),_:1}),c(t,{class:"user-block-wrap"},{default:n((()=>[c(t,null,{default:n((()=>[i(p(e.$t("blockList"))+":",1)])),_:1}),c(I,{checked:S.value,onChange:F},null,8,["checked"])])),_:1}),c(t,{class:"user-opt-wrap"},{default:n((()=>[c(w,{class:"opt-btn",type:"primary",onClick:T},{default:n((()=>[i(p(e.$t("sendMessage")),1)])),_:1}),c(w,{class:"opt-btn",type:"warn",onClick:J},{default:n((()=>[i(p(e.$t("deleteFriend")),1)])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-9dfa4a9c"]]),b=D(e({__name:"index",setup(e){const a=s(),{t:l}=t(),r=()=>{a.setViewedGroupInfo({groupName:"",groupId:""})},f=()=>{uni.navigateTo({url:`../../pages/Chat/index?type=groupChat&id=${a.viewedGroupInfo.groupId}`}),r()},I=()=>{uni.navigateTo({url:`../../pages/GroupDetail/index?id=${a.viewedGroupInfo.groupId}`})},w=async()=>{await a.destroyGroup(a.viewedGroupInfo.groupId),r(),uni.showToast({title:l("destroyGroupSuccess")})},k=async()=>{await a.leaveGroup(a.viewedGroupInfo.groupId),r(),uni.showToast({title:l("leaveGroupSuccess")})};return(e,s)=>{const l=A,t=g,v=h;return o(),u(t,{class:"group-wrap"},{default:n((()=>[c(t,{class:"group-header-wrap"},{default:n((()=>[c(l,{onClick:r,class:"arrow-back",src:d(E)},null,8,["src"]),c(t,{class:"title"},{default:n((()=>[i(p(e.$t("groupDetail")),1)])),_:1})])),_:1}),c(t,{class:"group-info-wrap"},{default:n((()=>[c(Q,{class:"group-avatar",src:"",placeholder:d(O)},null,8,["placeholder"]),c(t,null,{default:n((()=>[c(t,{class:"groupname"},{default:n((()=>[i(p(d(a).viewedGroupInfo.groupName),1)])),_:1}),c(t,{class:"group-id"},{default:n((()=>[i("GroupId: "+p(d(a).viewedGroupInfo.groupId)+"（"+p(d(a).viewedGroupInfo.public?e.$t("publicGroup"):e.$t("privateGroup"))+"）",1)])),_:1})])),_:1})])),_:1}),c(t,{class:"group-opt-wrap"},{default:n((()=>[c(v,{class:"opt-btn",type:"primary",onClick:f},{default:n((()=>[i(p(e.$t("enterGroup")),1)])),_:1}),c(v,{class:"opt-btn",onClick:I},{default:n((()=>[i(p(e.$t("groupDetail")),1)])),_:1}),"owner"===d(a).viewedGroupInfo.role?(o(),u(v,{key:0,class:"opt-btn",type:"warn",onClick:w},{default:n((()=>[i(p(e.$t("destroyGroup")),1)])),_:1})):m("",!0),"owner"!==d(a).viewedGroupInfo.role?(o(),u(v,{key:1,class:"opt-btn",type:"warn",onClick:k},{default:n((()=>[i(p(e.$t("leaveGroup")),1)])),_:1})):m("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-57a929a6"]]),F=D(e({__name:"index",setup(e){const l=r(!0),t=r(!1),A=I(),f=a(),k=s(),v=w(),{getUserInfoFromStore:C}=v,{setViewedUserInfo:h}=f,{setViewedGroupInfo:D}=k,E=()=>{l.value=!0,t.value=!0},F=()=>{l.value=!1,t.value=!0},T=()=>{t.value=!1},H=()=>{uni.navigateTo({url:"../../pages/CreateGroup/index"})};return(e,a)=>{const s=g;return o(),u(s,{class:"contact-list-wrap"},{default:n((()=>[d(f).viewedUserInfo.userId?(o(),u(U,{key:0})):m("",!0),d(k).viewedGroupInfo.groupId?(o(),u(b,{key:1})):m("",!0),t.value?(o(),u(S,{key:2,searchType:l.value?"contact":"group",onOnCancel:T},null,8,["searchType"])):(o(),u(s,{key:3},{default:n((()=>[c(s,{class:"contact-search menu-item"},{default:n((()=>[c(s,{onClick:E},{default:n((()=>[i(p(e.$t("addContact"))+" >",1)])),_:1})])),_:1}),c(s,{class:"contact-search menu-item"},{default:n((()=>[c(s,{onClick:F},{default:n((()=>[i(p(e.$t("addGroup"))+" >",1)])),_:1})])),_:1}),c(s,{class:"menu-item"},{default:n((()=>[c(s,{onClick:H},{default:n((()=>[i(p(e.$t("createGroup"))+" >",1)])),_:1})])),_:1}),c(s,{class:"menu-item"},{default:n((()=>[i(p(e.$t("blockList")),1)])),_:1}),(o(!0),B(y,null,G(d(A).blockList,(e=>(o(),u(s,{class:"item-wrap",key:e},{default:n((()=>[c(Q,{class:"user-avatar",src:d(C)(e).avatar,placeholder:d(_)},null,8,["src","placeholder"]),c(s,{class:"item-name ellipsis"},{default:n((()=>[i(p(d(C)(e).name),1)])),_:2},1024)])),_:2},1024)))),128)),c(s,{class:"menu-item"},{default:n((()=>[i(p(e.$t("contact")),1)])),_:1}),c(s,{class:"items-wrap"},{default:n((()=>[(o(!0),B(y,null,G(d(f).contacts,(e=>(o(),u(s,{class:"item-wrap",key:e.userId,onClick:a=>(e=>{h(e)})(e)},{default:n((()=>[c(Q,{class:"user-avatar",src:d(C)(e.userId).avatar,placeholder:d(_)},null,8,["src","placeholder"]),c(s,{class:"item-name ellipsis"},{default:n((()=>[i(p(d(C)(e.userId).name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),c(s,{class:"menu-item"},{default:n((()=>[i(p(e.$t("groupList")),1)])),_:1}),c(s,{class:"items-wrap"},{default:n((()=>[(o(!0),B(y,null,G(d(k).joinedGroupList,(e=>(o(),u(s,{class:"item-wrap",key:e.groupId,onClick:a=>(e=>{D(e)})(e)},{default:n((()=>[c(Q,{class:"user-avatar",src:"",placeholder:d(O)},null,8,["placeholder"]),c(s,{class:"item-name ellipsis"},{default:n((()=>[i(p(e.groupName),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-8efe8d67"]]);export{F as default};
