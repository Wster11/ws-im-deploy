import{d as e,K as a,F as l,S as t,a as s,r,o as u,c as o,w as d,b as c,e as n,t as i,J as p,s as f,k as _,l as v,T as m,E as w,G as I,f as k,x as h,A as C,n as g,U as y,m as G,g as $,M as b,N as U,O as x}from"./index-570604c4.js";import{A as V,d as S}from"./defaultAvatar.b2cfb2fc.js";import{d as L}from"./defaultGroupAvatar.4ee83176.js";import{_ as j}from"./_plugin-vue_export-helper.1b428a4d.js";const A=j(e({__name:"index",props:{searchType:{}},emits:["onCancel"],setup(e,{emit:m}){const w=e,{searchType:I}=w,{addContact:k,contacts:h}=a(),{applyJoinGroup:C}=l(),{getChatConn:g}=t(),y=g(),G=m,{t:$}=s(),b=r(""),U=r(!1),x=()=>{U.value=!0},j=()=>{G("onCancel")},A=()=>{if("contact"===I){if(b.value===y.user)return void f({icon:"none",title:$("disabledAddSelf")});if(null==h?void 0:h.find((e=>e.userId===b.value)))return void f({icon:"none",title:$("alreadyContact")});k(b.value),f({title:$("requestSended")})}else C(b.value).then((()=>{f({title:$("requestSended")})})).catch((e=>{var a;f({icon:"none",title:null==(a=null==e?void 0:e.data)?void 0:a.error_description})}))};return(e,a)=>{const l=_,t=v;return u(),o(l,{class:"contact-search-wrap"},{default:d((()=>[c(l,{class:"search-title-wrap"},{default:d((()=>[c(l,{onClick:j,class:"back"},{default:d((()=>[n(i("<"))])),_:1}),c(l,{class:"title"},{default:d((()=>[n(i("contact"===p(I)?e.$t("addContact"):e.$t("addGroup")),1)])),_:1})])),_:1}),c(l,{class:"input-content-wrap"},{default:d((()=>[c(l,{class:"input-wrap"},{default:d((()=>[c(t,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e),onConfirm:x,placeholder:e.$t("searchPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),c(l,{onClick:j,class:"cancel"},{default:d((()=>[n(i(e.$t("cancel")),1)])),_:1})])),_:1}),c(l,{class:"search-content"},{default:d((()=>[U.value?(u(),o(l,{key:1,class:"search-result"},{default:d((()=>[c(l,{class:"search-result-item"},{default:d((()=>[c(l,{class:"info-wrap"},{default:d((()=>[c(V,{src:"",placeholder:"contact"===p(I)?p(S):p(L)},null,8,["placeholder"]),c(l,{class:"user-id"},{default:d((()=>[n(i(b.value),1)])),_:1})])),_:1}),c(l,{class:"add",onClick:A},{default:d((()=>[n(i(e.$t("add")),1)])),_:1})])),_:1})])),_:1})):(u(),o(l,{key:0},{default:d((()=>[n(i(e.$t("searchNoContact")),1)])),_:1}))])),_:1})])),_:1})}}}),[["__scopeId","data-v-04b9972f"]]),N=j(e({__name:"index",setup(e){const l=a(),t=m(),$=w(),{t:b}=s(),{blockUser:U,unBlockUser:x}=t,L=r(""),j=r(!1),A=I((()=>t.blockList.includes(l.viewedUserInfo.userId))),N=()=>{l.setViewedUserInfo({userId:"",remark:""})},T=async()=>{await l.setContactRemark(l.viewedUserInfo.userId,L.value),l.setViewedUserInfo({userId:l.viewedUserInfo.userId,remark:L.value}),j.value=!1},D=async e=>{h();try{e.detail.value?await U(l.viewedUserInfo.userId):await x(l.viewedUserInfo.userId),C()}catch(a){C()}C()},F=()=>{g({url:`../../pages/Chat/index?type=singleChat&id=${l.viewedUserInfo.userId}`}),N()},q=I((()=>$.getUserInfoFromStore(l.viewedUserInfo.userId))),J=()=>{l.deleteContact(l.viewedUserInfo.userId).then((()=>{f({title:b("deleteSuccess")}),N()}))};return(e,a)=>{const t=_,s=v,r=y,f=G;return u(),o(t,{class:"user-wrap"},{default:d((()=>[c(t,{class:"user-header-wrap"},{default:d((()=>[c(t,{onClick:N,class:"back"},{default:d((()=>[n(i("<"))])),_:1}),c(t,{class:"title"},{default:d((()=>[n(i(e.$t("contactDetail")),1)])),_:1})])),_:1}),c(t,{class:"user-info-wrap"},{default:d((()=>[c(V,{class:"user-avatar",src:q.value.avatar,placeholder:p(S)},null,8,["src","placeholder"]),c(t,null,{default:d((()=>[c(t,{class:"remark"},{default:d((()=>[n(i(q.value.name),1)])),_:1}),c(t,{class:"user-id"},{default:d((()=>[n(i(p(l).viewedUserInfo.userId),1)])),_:1})])),_:1})])),_:1}),c(t,{class:"user-remark-wrap"},{default:d((()=>[c(t,null,{default:d((()=>[n(i(e.$t("remark"))+": ",1),k("span",null,i(j.value?"":p(l).viewedUserInfo.remark),1)])),_:1}),j.value?(u(),o(s,{key:0,class:"remark-input",onConfirm:T,placeholder:e.$t("remarkPlaceholder"),modelValue:L.value,"onUpdate:modelValue":a[0]||(a[0]=e=>L.value=e)},null,8,["placeholder","modelValue"])):(u(),o(t,{key:1,onClick:a[1]||(a[1]=e=>j.value=!0)},{default:d((()=>[n(i(e.$t("editRemark")),1)])),_:1}))])),_:1}),c(t,{class:"user-block-wrap"},{default:d((()=>[c(t,null,{default:d((()=>[n(i(e.$t("blockList"))+":",1)])),_:1}),c(r,{checked:A.value,onChange:D},null,8,["checked"])])),_:1}),c(t,{class:"user-opt-wrap"},{default:d((()=>[c(f,{class:"opt-btn",type:"primary",onClick:F},{default:d((()=>[n(i(e.$t("sendMessage")),1)])),_:1}),c(f,{class:"opt-btn",type:"warn",onClick:J},{default:d((()=>[n(i(e.$t("deleteFriend")),1)])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-a870cdeb"]]),T=j(e({__name:"index",setup(e){const a=l(),{t:t}=s(),r=()=>{a.setViewedGroupInfo({groupName:"",groupId:""})},v=()=>{g({url:`../../pages/Chat/index?type=groupChat&id=${a.viewedGroupInfo.groupId}`}),r()},m=()=>{g({url:`../../pages/GroupDetail/index?id=${a.viewedGroupInfo.groupId}`})},w=async()=>{await a.destroyGroup(a.viewedGroupInfo.groupId),r(),f({title:t("destroyGroupSuccess")})},I=async()=>{await a.leaveGroup(a.viewedGroupInfo.groupId),r(),f({title:t("leaveGroupSuccess")})};return(e,l)=>{const t=_,s=G;return u(),o(t,{class:"group-wrap"},{default:d((()=>[c(t,{class:"group-header-wrap"},{default:d((()=>[c(t,{onClick:r,class:"back"},{default:d((()=>[n(i("<"))])),_:1}),c(t,{class:"title"},{default:d((()=>[n(i(e.$t("groupDetail")),1)])),_:1})])),_:1}),c(t,{class:"group-info-wrap"},{default:d((()=>[c(V,{class:"group-avatar",src:"",placeholder:p(L)},null,8,["placeholder"]),c(t,null,{default:d((()=>[c(t,{class:"groupname"},{default:d((()=>[n(i(p(a).viewedGroupInfo.groupName),1)])),_:1}),c(t,{class:"group-id"},{default:d((()=>[n("GroupId: "+i(p(a).viewedGroupInfo.groupId)+"（"+i(p(a).viewedGroupInfo.public?e.$t("publicGroup"):e.$t("privateGroup"))+"）",1)])),_:1})])),_:1})])),_:1}),c(t,{class:"group-opt-wrap"},{default:d((()=>[c(s,{class:"opt-btn",type:"primary",onClick:v},{default:d((()=>[n(i(e.$t("enterGroup")),1)])),_:1}),c(s,{class:"opt-btn",onClick:m},{default:d((()=>[n(i(e.$t("groupDetail")),1)])),_:1}),"owner"===p(a).viewedGroupInfo.role?(u(),o(s,{key:0,class:"opt-btn",type:"warn",onClick:w},{default:d((()=>[n(i(e.$t("destroyGroup")),1)])),_:1})):$("",!0),"owner"!==p(a).viewedGroupInfo.role?(u(),o(s,{key:1,class:"opt-btn",type:"warn",onClick:I},{default:d((()=>[n(i(e.$t("leaveGroup")),1)])),_:1})):$("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-904cb188"]]),D=j(e({__name:"index",setup(e){const t=r(!0),s=r(!1),f=m(),v=a(),I=l(),k=w(),{getUserInfoFromStore:h}=k,{setViewedUserInfo:C}=v,{setViewedGroupInfo:y}=I,G=()=>{t.value=!0,s.value=!0},j=()=>{t.value=!1,s.value=!0},D=()=>{s.value=!1},F=()=>{g({url:"../../pages/CreateGroup/index"})};return(e,a)=>{const l=_;return u(),o(l,{class:"contact-list-wrap"},{default:d((()=>[p(v).viewedUserInfo.userId?(u(),o(N,{key:0})):$("",!0),p(I).viewedGroupInfo.groupId?(u(),o(T,{key:1})):$("",!0),s.value?(u(),o(A,{key:2,searchType:t.value?"contact":"group",onOnCancel:D},null,8,["searchType"])):(u(),o(l,{key:3},{default:d((()=>[c(l,{class:"contact-search menu-item"},{default:d((()=>[c(l,{onClick:G},{default:d((()=>[n(i(e.$t("addContact"))+" >",1)])),_:1})])),_:1}),c(l,{class:"contact-search menu-item"},{default:d((()=>[c(l,{onClick:j},{default:d((()=>[n(i(e.$t("addGroup"))+" >",1)])),_:1})])),_:1}),c(l,{class:"menu-item"},{default:d((()=>[c(l,{onClick:F},{default:d((()=>[n(i(e.$t("createGroup"))+" >",1)])),_:1})])),_:1}),c(l,{class:"menu-item"},{default:d((()=>[n(i(e.$t("blockList")),1)])),_:1}),(u(!0),b(x,null,U(p(f).blockList,(e=>(u(),o(l,{class:"item-wrap",key:e},{default:d((()=>[c(V,{class:"user-avatar",src:p(h)(e).avatar,placeholder:p(S)},null,8,["src","placeholder"]),c(l,{class:"item-name ellipsis"},{default:d((()=>[n(i(p(h)(e).name),1)])),_:2},1024)])),_:2},1024)))),128)),c(l,{class:"menu-item"},{default:d((()=>[n(i(e.$t("contact")),1)])),_:1}),c(l,{class:"items-wrap"},{default:d((()=>[(u(!0),b(x,null,U(p(v).contacts,(e=>(u(),o(l,{class:"item-wrap",key:e.userId,onClick:a=>(e=>{C(e)})(e)},{default:d((()=>[c(V,{class:"user-avatar",src:p(h)(e.userId).avatar,placeholder:p(S)},null,8,["src","placeholder"]),c(l,{class:"item-name ellipsis"},{default:d((()=>[n(i(p(h)(e.userId).name),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),c(l,{class:"menu-item"},{default:d((()=>[n(i(e.$t("groupList")),1)])),_:1}),c(l,{class:"items-wrap"},{default:d((()=>[(u(!0),b(x,null,U(p(I).joinedGroupList,(e=>(u(),o(l,{class:"item-wrap",key:e.groupId,onClick:a=>(e=>{y(e)})(e)},{default:d((()=>[c(V,{class:"user-avatar",src:"",placeholder:p(L)},null,8,["placeholder"]),c(l,{class:"item-name ellipsis"},{default:d((()=>[n(i(e.groupName),1)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-8efe8d67"]]);export{D as default};
