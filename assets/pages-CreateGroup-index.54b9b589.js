import{d as e,a,D as l,y as s,z as u,r as t,o,c as r,w as c,b as d,e as n,t as i,F as p,G as m,g as v,H as f,k as _,l as h,N as g,q as b,m as w,n as I,p as $}from"./index-d37a6b04.js";import{A as k,d as V}from"./defaultAvatar.12922afc.js";import{_ as x}from"./_plugin-vue_export-helper.1b428a4d.js";const G=x(e({__name:"index",setup(e){const{t:x}=a(),G=l(),j=s(),{getUserInfoFromStore:C}=j,{createGroup:N}=u(),T=t([]),D=t(""),U=t(""),y=t(!0),A=e=>{T.value=e.detail.value},F=e=>{y.value=e.detail.value},P=()=>{""===D.value&&(D.value=G.contacts.filter((e=>T.value.includes(e.userId))).map((e=>C(e.userId).name)).join(",")),""===U.value&&(U.value="group desc"),N({data:{groupname:D.value,members:T.value,desc:U.value,public:y.value,allowinvites:!0,inviteNeedConfirm:!1,approval:!1,maxusers:500}}).then((()=>{uni.showToast({icon:"none",title:x("createGroupSuccess"),duration:2e3});const e=setTimeout((()=>{uni.navigateBack(),clearTimeout(e)}),1e3)})).catch((e=>{uni.showToast({icon:"none",title:e.message})}))};return(e,a)=>{const l=_,s=h,u=g,t=I,x=$,j=b,N=w;return o(),r(l,{class:"create-group-wrap"},{default:c((()=>[d(l,{class:"content"},{default:c((()=>[d(l,{class:"input-wrap"},{default:c((()=>[d(l,{class:"label"},{default:c((()=>[n(i(e.$t("groupName")),1)])),_:1}),d(s,{modelValue:D.value,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value=e),placeholder:e.$t("groupNamePlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),d(l,{class:"input-wrap"},{default:c((()=>[d(l,{class:"label"},{default:c((()=>[n(i(e.$t("groupDesc")),1)])),_:1}),d(s,{modelValue:U.value,"onUpdate:modelValue":a[1]||(a[1]=e=>U.value=e),placeholder:e.$t("groupDescPlaceholder")},null,8,["modelValue","placeholder"])])),_:1}),d(l,{class:"label"},{default:c((()=>[n(i(e.$t("publicGroup")),1)])),_:1}),d(u,{class:"switch",checked:y.value,onChange:F},null,8,["checked"]),d(l,{class:"label"},{default:c((()=>[n(i(e.$t("groupMember")),1)])),_:1}),d(j,{class:"uni-list",onChange:A},{default:c((()=>[(o(!0),p(f,null,m(v(G).contacts,(e=>(o(),r(x,{class:"uni-list-cell uni-list-cell-pd",key:e.userId},{default:c((()=>[d(l,null,{default:c((()=>[d(t,{value:e.userId},null,8,["value"])])),_:2},1024),d(l,{class:"user-item-wrap"},{default:c((()=>[d(k,{src:v(C)(e.userId).avatar,placeholder:v(V)},null,8,["src","placeholder"]),d(l,{class:"user-name ellipsis"},{default:c((()=>[n(i(v(C)(e.userId).name),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),d(N,{class:"create-btn",onClick:P,disabled:0===T.value.length},{default:c((()=>[n(i(e.$t("createGroup")),1)])),_:1},8,["disabled"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-c6e2cae1"]]);export{G as default};
